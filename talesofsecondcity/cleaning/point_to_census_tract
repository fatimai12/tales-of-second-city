"""
CAPP 30122
Team: Tales of Second City
Author: Fatima Irfan

Map point data file rows to corresponding census tracts
"""

from geopy.geocoders import Nominatim
import pandas as pd
import geopandas as gpd

geolocator = Nominatim(user_agent="talesofsecondcity")
census_tracts = gpd.read_file("../data/original/Boundaries - Census Tracts - 2010.geojson")
l_stops_df = pd.read_csv("../data/original/CTA_-_System_Information_-_List_of__L__Stops_-_Map.csv")

for row in l_stops_df.itertuples():
    location = row.Location.strip("()").split(",")
    lat = location[0]
    long = location[1]
    address = geolocator.reverse((lat, long)).raw['address']



address = geolocator.reverse(latitude, longitude)